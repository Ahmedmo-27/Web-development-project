<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="PaymentCard.js" />
    <link rel="stylesheet" href="PaymentCard.css" />
    <link rel="icon" type="image/x-icon" href="/images/logo.ico" />
    <style>
      /* Updated 3D card styles */
      .card-flip-container {
        width: 350px;
        height: 200px;
        perspective: 1000px;
        margin: 20px auto 10px;
      }

      #flip-card {
        width: 100%;
        height: 100%;
        color: white;
        transition: transform 1s;
        position: relative;
        border-radius: 15px;
        font-family: "Arial", sans-serif;
        transform-style: preserve-3d;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }

      #flip-card.flipped {
        transform: rotateY(180deg);
      }

      #flip-front,
      #flip-back {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 15px;
        backface-visibility: hidden;
        padding: 25px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      #flip-front {
        background: linear-gradient(135deg, #1a1a2e, #16213e);
      }

      #flip-back {
        background: linear-gradient(135deg, #16213e, #0f3460);
        transform: rotateY(180deg);
        justify-content: flex-end;
      }

      .card-header {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .bank-name {
        font-size: 16px;
        font-weight: 600;
      }

      .card-holder {
        font-size: 14px;
        margin-top: 5px;
      }

      .card-number {
        font-size: 18px;
        letter-spacing: 2px;
        word-spacing: 10px;
        text-align: center;
        margin: 20px 0;
      }

      .card-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .expiry-date {
        font-size: 14px;
        text-align: right;
      }

      .card-stripe {
        background-color: #000;
        height: 40px;
        margin: 0 -25px;
      }

      .card-signature {
        background-color: #fff;
        color: #000;
        height: 30px;
        width: 80%;
        margin: 10px 0;
        display: flex;
        align-items: center;
        padding-left: 10px;
        font-style: italic;
      }

      .card-cvv {
        text-align: right;
        font-size: 14px;
      }

      .flip-card-btn {
        padding: 10px 20px;
        background: #050a30;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.3s;
        display: block;
        margin: 10px auto 20px;
        width: fit-content;
      }

      .flip-card-btn:hover {
        background: #1a237e;
      }

      /* Complete Purchase Button - Updated to match image */
      .complete-purchase-btn {
        display: block;
        width: 100%;
        padding: 15px;
        margin: 30px auto 0;
        background-color: #050a30;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        font-weight: bold;
        text-align: center;
        cursor: pointer;
        transition: background-color 0.3s;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .complete-purchase-btn:hover {
        background-color: #1a237e;
      }

      /* Validation styles */
      .error {
        color: #ff0000;
        font-size: 12px;
        margin-top: 5px;
        display: none;
      }

      input.invalid {
        border-color: #ff0000;
      }

      input.valid {
        border-color: #00cc00;
      }
    </style>
    <title>Secure Checkout || Vaultique</title>
  </head>

  <body>
    <a href="/" class="logo" id="logo">Vaultique</a>
    <br />
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress"></div>
      </div>
      <div class="progress-steps">
        <div class="step completed">
          <span class="circle">&#10003;</span>
          <span class="label">Payment</span>
        </div>
        <div class="step completed">
          <span class="circle">&#10003;</span>
          <span class="label">Shipping</span>
        </div>
        <div class="step active">
          <span class="circle"></span>
          <span class="label">Leave a review!</span>
        </div>
      </div>
    </div>

    <div class="container hidden">
      <!-- Your existing payment form container -->
    </div>

    <div class="form-container">
      <h2 class="form-title">Payment</h2>
      <form action="" class="checkout-form" id="checkoutForm">
        <div class="input-line">
          <label for="name">FULL NAME</label>
          <input
            type="text"
            name="name"
            id="name"
            placeholder="Your name and surname"
            value="Mohamed Mekawy"
          />
        </div>
        <div class="input-line">
          <label for="card-number">Credit Card Number</label>
          <input
            type="text"
            name="card-number"
            id="card-number"
            placeholder="1234 5678 9012 3456"
            value=""
            maxlength="19"
          />
        </div>

        <!-- Added Bank Name Field -->
        <div class="input-line">
          <label for="bank-name">BANK NAME</label>
          <input
            type="text"
            name="bank-name"
            id="bank-name"
            placeholder="Your bank name"
            value=""
          />
        </div>

        <div class="input-container">
          <div class="input-line">
            <label for="cvv">CVV</label>
            <input
              type="text"
              name="cvv"
              id="cvv"
              placeholder="123"
              value=""
              maxlength="4"
              class="cvv-input"
            />
            <p class="error" id="cvvError">
              Please enter a valid 3 or 4 digit CVV
            </p>
          </div>

          <div class="input-line">
            <label for="expiry">Expiry (MM/YY)</label>
            <input
              type="text"
              name="expiry"
              id="expiry"
              placeholder="MM/YY"
              value=""
              maxlength="5"
              class="expiry-input"
            />
            <p class="error" id="expiryError">
              Please enter a valid expiry date in MM/YY format
            </p>
          </div>
        </div>

        <button type="button" class="flip-card-btn" id="flip-card-btn">
          View Card Details
        </button>
        <!-- 3D Flip Card Component -->
        <div class="card-flip-container">
          <div id="flip-card">
            <div id="flip-front">
              <div class="card-header">
                <div class="bank-name" id="display-bank-name">BANK NAME</div>
                <div class="card-holder" id="display-card-holder">
                  FULL NAME
                </div>
              </div>
              <div class="card-number" id="display-card-number">
                ################
              </div>
              <div class="card-footer">
                <div class="expiry-date" id="display-expiry">MM/YY</div>
              </div>
            </div>
            <div id="flip-back">
              <div class="card-stripe"></div>
              <div class="card-signature">Authorized Signature</div>
              <div class="card-cvv" id="display-cvv">CVV</div>
            </div>
          </div>
        </div>

        <!-- Updated Complete Purchase Button -->
        <button
          type="submit"
          class="complete-purchase-btn"
          onclick="handleFormSubmission(event)"
        >
          Complete purchase
        </button>
      </form>
    </div>

    <script src="/Javascript/Checkout.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Flip card functionality
        const flipCard = document.getElementById("flip-card");
        const flipBtn = document.getElementById("flip-card-btn");
        let isFlipped = false;

        flipBtn.addEventListener("click", () => {
          isFlipped = !isFlipped;
          if (isFlipped) {
            flipCard.classList.add("flipped");
            flipBtn.textContent = "Hide Card Details";
          } else {
            flipCard.classList.remove("flipped");
            flipBtn.textContent = "View Card Details";
          }
        });

        // Form input bindings to card display
        const nameInput = document.getElementById("name");
        const bankNameInput = document.getElementById("bank-name");
        const cardNumberInput = document.getElementById("card-number");
        const cvvInput = document.getElementById("cvv");
        const expiryInput = document.getElementById("expiry");

        // Display elements
        const displayName = document.getElementById("display-card-holder");
        const displayBankName = document.getElementById("display-bank-name");
        const displayNumber = document.getElementById("display-card-number");
        const displayCvv = document.getElementById("display-cvv");
        const displayExpiry = document.getElementById("display-expiry");

        // Bind input events
        nameInput.addEventListener("input", function () {
          displayName.textContent = this.value || "FULL NAME";
        });

        bankNameInput.addEventListener("input", function () {
          displayBankName.textContent = this.value || "BANK NAME";
        });

        cardNumberInput.addEventListener("input", function () {
          let value = this.value.replace(/\s/g, "");
          let formatted = "";
          for (let i = 0; i < value.length; i++) {
            if (i > 0 && i % 4 === 0) formatted += " ";
            formatted += value[i];
          }
          displayNumber.textContent = formatted || "################";
          this.value = formatted;
        });

        cvvInput.addEventListener("input", function () {
          const cvv = this.value;
          displayCvv.textContent = cvv
            ? `CVV: ${cvv.replace(/./g, "â€¢")}`
            : "CVV";

          // CVV validation
          const isValid = /^\d{3,4}$/.test(cvv);
          document.getElementById("cvvError").style.display =
            cvv && !isValid ? "block" : "none";
          this.classList.toggle("invalid", cvv && !isValid);
          this.classList.toggle("valid", cvv && isValid);
        });

        expiryInput.addEventListener("input", function () {
          let value = this.value.replace(/\D/g, "");
          if (value.length > 2) {
            value = value.substring(0, 2) + "/" + value.substring(2, 4);
          }
          displayExpiry.textContent = value ? `Expires: ${value}` : "MM/YY";
          this.value = value;

          // Expiry validation
          const isValid = /^\d{2}\/\d{2}$/.test(value);
          document.getElementById("expiryError").style.display =
            value && !isValid ? "block" : "none";
          this.classList.toggle("invalid", value && !isValid);
          this.classList.toggle("valid", value && isValid);
        });
      });

      function handleFormSubmission(event) {
        event.preventDefault();
        // Your existing form submission logic
      }
    </script>
  </body>
</html>
